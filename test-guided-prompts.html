<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guided Prompts Test</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Realistic implementation of GuidedPrompts - testing with actual webhook
        const { useState } = React;

        const MARITIME_PROMPTS = [
            "Show fault code 110-00 solutions",
            "Find CAT fuel filter maintenance", 
            "Hydraulic pump service manual",
            "Generator troubleshooting steps"
        ];

        function GuidedPrompts({ onPromptSelect }) {
            const [selectedPrompt, setSelectedPrompt] = useState(null);
            const [isProcessing, setIsProcessing] = useState(false);

            const handlePromptClick = async (prompt, index) => {
                if (isProcessing) return;
                
                setSelectedPrompt(index);
                setIsProcessing(true);
                
                console.log('[GuidedPrompts] Selected:', prompt);
                
                try {
                    if (onPromptSelect) {
                        await onPromptSelect(prompt);
                    }
                    
                    setTimeout(() => {
                        setSelectedPrompt(null);
                        setIsProcessing(false);
                    }, 1000);
                } catch (error) {
                    console.error('[GuidedPrompts] Error:', error);
                    setSelectedPrompt(null);
                    setIsProcessing(false);
                }
            };

            return React.createElement('div', {
                style: {
                    display: 'flex',
                    flexDirection: 'column',
                    alignItems: 'center',
                    gap: '16px',
                    padding: '20px',
                    fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
                }
            }, [
                React.createElement('div', {
                    key: 'title',
                    style: {
                        fontSize: '18px',
                        fontWeight: '500',
                        color: '#374151',
                        textAlign: 'center',
                        marginBottom: '8px'
                    }
                }, 'Try asking about:'),
                
                React.createElement('div', {
                    key: 'buttons',
                    style: {
                        display: 'flex',
                        flexWrap: 'wrap',
                        justifyContent: 'center',
                        gap: '8px',
                        maxWidth: '600px'
                    }
                }, MARITIME_PROMPTS.map((prompt, index) => 
                    React.createElement('button', {
                        key: index,
                        onClick: () => handlePromptClick(prompt, index),
                        disabled: isProcessing,
                        style: {
                            padding: '8px 16px',
                            background: selectedPrompt === index ? '#3b82f6' : '#f3f4f6',
                            color: selectedPrompt === index ? '#ffffff' : '#374151',
                            border: '1px solid #d1d5db',
                            borderRadius: '20px',
                            fontSize: '14px',
                            cursor: isProcessing ? 'wait' : 'pointer',
                            transition: 'all 0.2s ease',
                            opacity: isProcessing && selectedPrompt !== index ? 0.5 : 1
                        }
                    }, selectedPrompt === index ? 'Sending...' : prompt)
                )),
                
                isProcessing && React.createElement('div', {
                    key: 'processing',
                    style: {
                        fontSize: '12px',
                        color: '#6b7280',
                        fontStyle: 'italic'
                    }
                }, 'Processing your query...')
            ]);
        }

        function TestApp() {
            const [responses, setResponses] = useState([]);
            const [isLoading, setIsLoading] = useState(false);

            const handlePromptSelect = async (prompt) => {
                console.log('Testing webhook with prompt:', prompt);
                setIsLoading(true);
                
                try {
                    // Test with REAL webhook
                    const response = await fetch('https://api.celeste7.ai/webhook/text-chat-fast', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': 'application/json'
                        },
                        body: JSON.stringify({
                            query: prompt,
                            userId: 'test_user_' + Date.now(),
                            timestamp: new Date().toISOString()
                        })
                    });

                    const data = await response.json();
                    console.log('Webhook response:', data);
                    
                    setResponses(prev => [...prev, {
                        prompt,
                        response: data,
                        timestamp: new Date().toLocaleTimeString(),
                        success: response.ok
                    }]);
                    
                } catch (error) {
                    console.error('Webhook error:', error);
                    setResponses(prev => [...prev, {
                        prompt,
                        error: error.message,
                        timestamp: new Date().toLocaleTimeString(),
                        success: false
                    }]);
                } finally {
                    setIsLoading(false);
                }
            };

            return React.createElement('div', {
                style: { 
                    padding: '20px',
                    maxWidth: '800px',
                    margin: '0 auto',
                    fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
                }
            }, [
                React.createElement('h1', {
                    key: 'title',
                    style: { textAlign: 'center', marginBottom: '30px' }
                }, 'Guided Prompts - Real Webhook Test'),
                
                React.createElement(GuidedPrompts, {
                    key: 'prompts',
                    onPromptSelect: handlePromptSelect
                }),
                
                isLoading && React.createElement('div', {
                    key: 'loading',
                    style: {
                        textAlign: 'center',
                        padding: '20px',
                        background: '#fef3c7',
                        borderRadius: '8px',
                        marginTop: '20px'
                    }
                }, 'Testing webhook connection...'),
                
                responses.length > 0 && React.createElement('div', {
                    key: 'responses',
                    style: {
                        marginTop: '30px',
                        padding: '20px',
                        background: '#f9fafb',
                        borderRadius: '8px'
                    }
                }, [
                    React.createElement('h3', {
                        key: 'responses-title'
                    }, 'Webhook Test Results:'),
                    
                    ...responses.map((result, i) => 
                        React.createElement('div', {
                            key: i,
                            style: {
                                padding: '15px',
                                margin: '10px 0',
                                background: result.success ? '#d1fae5' : '#fee2e2',
                                borderRadius: '6px',
                                border: `1px solid ${result.success ? '#10b981' : '#ef4444'}`
                            }
                        }, [
                            React.createElement('div', {
                                key: 'meta',
                                style: { fontSize: '12px', color: '#6b7280', marginBottom: '8px' }
                            }, `${result.timestamp} - ${result.success ? 'SUCCESS' : 'ERROR'}`),
                            
                            React.createElement('div', {
                                key: 'prompt',
                                style: { fontWeight: 'bold', marginBottom: '8px' }
                            }, `Query: "${result.prompt}"`),
                            
                            React.createElement('div', {
                                key: 'response',
                                style: { fontSize: '14px' }
                            }, result.error ? 
                                `Error: ${result.error}` : 
                                `Response: ${result.response?.response?.answer || 'No answer field'}`
                            )
                        ])
                    )
                ])
            ]);
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(TestApp));
    </script>
</body>
</html>